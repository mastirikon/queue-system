# ‚è±Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é –∑–∞–¥–∞—á

## üéØ –°–ø–æ—Å–æ–±—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## 1Ô∏è‚É£ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –∑–∞ —Ä–∞–∑)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `.env.production`:

```bash
WORKER_CONCURRENCY=1
```

**–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **—Ç–æ–ª—å–∫–æ 1 –∑–∞–¥–∞—á—É –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ**
- –°–ª–µ–¥—É—é—â–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞—á–Ω—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–π
- –ù–∏–∫–∞–∫–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –ï—Å–ª–∏ API –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ —Å—Ç—Ä–æ–≥–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ï—Å–ª–∏ API –∏–º–µ–µ—Ç rate limit

---

## 2Ô∏è‚É£ –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `.env.production`:

```bash
WORKER_CONCURRENCY=1
WORKER_DELAY_BETWEEN_TASK=2s
```

**–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ Worker –∂–¥—ë—Ç 2 —Å–µ–∫—É–Ω–¥—ã
- –ó–∞—Ç–µ–º –±–µ—Ä—ë—Ç —Å–ª–µ–¥—É—é—â—É—é –∑–∞–¥–∞—á—É –∏–∑ –æ—á–µ—Ä–µ–¥–∏
- –î–∞—ë—Ç "–ø–µ—Ä–µ–¥—ã—à–∫—É" API –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–¥–µ—Ä–∂–µ–∫:**
```bash
WORKER_DELAY_BETWEEN_TASK=0s    # –ë–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
WORKER_DELAY_BETWEEN_TASK=1s    # 1 —Å–µ–∫—É–Ω–¥–∞
WORKER_DELAY_BETWEEN_TASK=2s    # 2 —Å–µ–∫—É–Ω–¥—ã
WORKER_DELAY_BETWEEN_TASK=5s    # 5 —Å–µ–∫—É–Ω–¥
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ API –∏–º–µ–µ—Ç rate limit (–Ω–∞–ø—Ä–∏–º–µ—Ä, 30 req/min)
- ‚úÖ –ù—É–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –•–æ—á–µ—à—å –±—ã—Ç—å "–≤–µ–∂–ª–∏–≤—ã–º" –∫ API

---

## 3Ô∏è‚É£ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á —Å—Ä–∞–∑—É)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `.env.production`:

```bash
WORKER_CONCURRENCY=10
WORKER_DELAY_BETWEEN_TASK=0s
```

**–ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç **–¥–æ 10 –∑–∞–¥–∞—á –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ë–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ API –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ –ù—É–∂–Ω–∞ –≤—ã—Å–æ–∫–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- ‚úÖ –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ rate limit

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤

### –†–µ–∂–∏–º 1: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
```bash
WORKER_CONCURRENCY=1
WORKER_DELAY_BETWEEN_TASK=0s
```
**–°–∫–æ—Ä–æ—Å—Ç—å:** ~60 –∑–∞–¥–∞—á/–º–∏–Ω (–ø—Ä–∏ timeout 1s)  
**–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API:** –ù–∏–∑–∫–∞—è  
**–†–∏—Å–∫ rate limit:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

### –†–µ–∂–∏–º 2: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
```bash
WORKER_CONCURRENCY=1
WORKER_DELAY_BETWEEN_TASK=2s
```
**–°–∫–æ—Ä–æ—Å—Ç—å:** ~20 –∑–∞–¥–∞—á/–º–∏–Ω  
**–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API:** –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è  
**–†–∏—Å–∫ rate limit:** –ù—É–ª–µ–≤–æ–π

### –†–µ–∂–∏–º 3: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π
```bash
WORKER_CONCURRENCY=10
WORKER_DELAY_BETWEEN_TASK=0s
```
**–°–∫–æ—Ä–æ—Å—Ç—å:** ~600 –∑–∞–¥–∞—á/–º–∏–Ω  
**–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ API:** –í—ã—Å–æ–∫–∞—è  
**–†–∏—Å–∫ rate limit:** –í—ã—Å–æ–∫–∏–π (–µ—Å–ª–∏ –µ—Å—Ç—å –ª–∏–º–∏—Ç—ã)

---

## üîß –ö–∞–∫ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º

### –°–ø–æ—Å–æ–± 1: –õ–æ–∫–∞–ª—å–Ω–æ + –¥–µ–ø–ª–æ–π

```bash
# 1. –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—à—å .env.production
nano .env.production

# –ú–µ–Ω—è–µ—à—å:
WORKER_CONCURRENCY=1
WORKER_DELAY_BETWEEN_TASK=2s

# 2. –î–µ–ø–ª–æ–∏—à—å
./deploy.sh
```

### –°–ø–æ—Å–æ–± 2: –ü—Ä—è–º–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∞–µ—à—å—Å—è
ssh root@vdska

# 2. –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ—à—å
cd /home/finance-system/queue-system
nano .env

# –ú–µ–Ω—è–µ—à—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—à—å Worker
docker compose restart worker

# 4. –ü—Ä–æ–≤–µ—Ä—è–µ—à—å –ª–æ–≥–∏
docker compose logs worker -f
```

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### Google Sheets API (rate limit: 60 req/min)
```bash
WORKER_CONCURRENCY=1
WORKER_DELAY_BETWEEN_TASK=1s
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ~60 req/min (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–∞)

### Webhook –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
```bash
WORKER_CONCURRENCY=5
WORKER_DELAY_BETWEEN_TASK=0s
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ~300 req/min

### –ú–µ–¥–ª–µ–Ω–Ω–æ–µ API (–º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –æ—Ç –Ω–∞–≥—Ä—É–∑–∫–∏)
```bash
WORKER_CONCURRENCY=1
WORKER_DELAY_BETWEEN_TASK=3s
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ~20 req/min (–æ—á–µ–Ω—å —â–∞–¥—è—â–∏–π —Ä–µ–∂–∏–º)

### Telegram Bot API (rate limit: 30 req/sec)
```bash
WORKER_CONCURRENCY=10
WORKER_DELAY_BETWEEN_TASK=0s
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ 600 req/min (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–∞)

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
ssh root@vdska
cd /home/finance-system/queue-system

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
cat .env | grep WORKER

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec queue-worker env | grep WORKER
```

### –í –ª–æ–≥–∞—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:
```bash
docker compose logs worker | head -20
```

–£–≤–∏–¥–∏—à—å:
```
Worker service starting...
Concurrency: 1
Retry interval: 10s
Delay between tasks: 2s
```

---

## üí° Pro Tips

### 1. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–µ–∑ –¥–µ–ø–ª–æ—è
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏ Worker
docker compose stop worker

# –ò–∑–º–µ–Ω–∏ .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
nano .env

# –ó–∞–ø—É—Å—Ç–∏ Worker
docker compose start worker
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
```bash
# –û—Ç–ø—Ä–∞–≤—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –ø–æ–¥—Ä—è–¥
for i in {1..5}; do
  curl -X POST http://vdska:8080/api/v1/tasks \
    -H "Content-Type: application/json" \
    -d '{"title": "Test '$i'"}'
done

# –°–º–æ—Ç—Ä–∏ –∫–∞–∫ –æ–Ω–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è
docker compose logs worker -f
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∫–æ—Ä–æ—Å—Ç–∏
–û—Ç–∫—Ä–æ–π Asynq Monitor: `http://vdska:8081`

–¢–∞–º —É–≤–∏–¥–∏—à—å:
- **Processed** - —Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
- **Active** - —Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á —Å–µ–π—á–∞—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- **Pending** - —Å–∫–æ–ª—å–∫–æ –∂–¥—ë—Ç –≤ –æ—á–µ—Ä–µ–¥–∏

---

## üÜò Troubleshooting

### –ó–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ?
**–£–≤–µ–ª–∏—á—å Concurrency:**
```bash
WORKER_CONCURRENCY=5
```

### API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 429 Too Many Requests?
**–£–º–µ–Ω—å—à–∏ Concurrency –∏ –¥–æ–±–∞–≤—å –∑–∞–¥–µ—Ä–∂–∫—É:**
```bash
WORKER_CONCURRENCY=1
WORKER_DELAY_BETWEEN_TASK=3s
```

### –ó–∞–¥–∞—á–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥–∏?
**–£–≤–µ–ª–∏—á—å Concurrency –∏–ª–∏ —É–º–µ–Ω—å—à–∏ –∑–∞–¥–µ—Ä–∂–∫—É:**
```bash
WORKER_CONCURRENCY=10
WORKER_DELAY_BETWEEN_TASK=0s
```

---

## üìñ –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä `.env.production`

```bash
# Environment
ENV=production

# API
API_PORT=8080
API_HOST=0.0.0.0

# Worker - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
WORKER_CONCURRENCY=1                      # –û–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –∑–∞ —Ä–∞–∑
WORKER_DELAY_BETWEEN_TASK=2s              # 2 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏
WORKER_RETRY_INTERVAL=10s                 # Retry –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
WORKER_REQUEST_TIMEOUT=30s                # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ 30 —Å–µ–∫—É–Ω–¥

# Target URL
WORKER_TARGET_URL=https://tasker-google-sheets.ku-34.netcraze.pro/notify
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚è±Ô∏è –ó–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –æ—á–µ—Ä–µ–¥–∏
- üïê –ú–µ–∂–¥—É –∑–∞–¥–∞—á–∞–º–∏ –ø–∞—É–∑–∞ 2 —Å–µ–∫—É–Ω–¥—ã
- ‚úÖ API –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–µ—Ç—Å—è
- üîÑ Retry –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
