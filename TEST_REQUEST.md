# üß™ –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

## –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π API –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–¢–µ–ø–µ—Ä—å API –ø—Ä–∏–Ω–∏–º–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**. URL –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞

### Curl:
```bash
curl -X POST http://81.85.72.23:8080/api/v1/tasks \
  -H "Content-Type: application/json" \
  -d '{
    "owner_app": "com.idamob.tinkoff.android",
    "title": "–í—Å–µ –æ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ",
    "text": "üöóüöóüöóüöóüöóüöóüöóüöóüöóüöóüöó",
    "subtext": "",
    "messages": "",
    "other_text": "üöó –ß—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å —É—Ö–æ–¥ –∑–∞ –º–∞—à–∏–Ω–æ–π, –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —Å–µ—Ä–≤–∏—Å–∞–º–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ê–≤—Ç–æ¬ª",
    "cat": "",
    "new_only": "true"
  }'
```

### Postman:
**URL:**
```
POST http://81.85.72.23:8080/api/v1/tasks
```

**Headers:**
```
Content-Type: application/json
```

**Body (raw JSON):**
```json
{
  "owner_app": "com.idamob.tinkoff.android",
  "title": "–í—Å–µ –æ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ",
  "text": "üöóüöóüöóüöóüöóüöóüöóüöóüöóüöóüöó",
  "subtext": "",
  "messages": "",
  "other_text": "üöó –ß—Ç–æ–±—ã —É–ø—Ä–æ—Å—Ç–∏—Ç—å —É—Ö–æ–¥ –∑–∞ –º–∞—à–∏–Ω–æ–π, –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —Å–µ—Ä–≤–∏—Å–∞–º–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ê–≤—Ç–æ¬ª",
  "cat": "",
  "new_only": "true"
}
```

---

## üì® –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

1. **API –ø–æ–ª—É—á–∞–µ—Ç** –¥–∞–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
2. **–°–æ–∑–¥–∞—ë—Ç –∑–∞–¥–∞—á—É** —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º URL: `https://tasker-google-sheets.ku-34.netcraze.pro/notify`
3. **Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç** –∑–∞–¥–∞—á—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ —ç—Ç–æ—Ç URL
4. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∞** - retry –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ –¥–æ 24 —á–∞—Å–æ–≤

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç

### –£—Å–ø–µ—Ö (201 Created):
```json
{
  "task_id": "550e8400-e29b-41d4-a716-446655440000",
  "message": "Task created successfully"
}
```

### –û—à–∏–±–∫–∞ (400 Bad Request):
```json
{
  "error": "invalid_request",
  "message": "Invalid JSON format"
}
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –õ–æ–≥–∏ Worker:
```bash
ssh root@vdska
cd /home/finance-system/queue-system
docker compose -f docker-compose-simple.yml logs worker -f
```

### Asynq Monitor:
–û—Ç–∫—Ä–æ–π –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://81.85.72.23:8081`

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–ª–∞—Ç–µ–∂–µ:
```json
{
  "owner_app": "com.idamob.tinkoff.android",
  "title": "–°–ø–∏—Å–∞–Ω–∏–µ",
  "text": "–ü–æ–∫—É–ø–∫–∞ 1 500 ‚ÇΩ",
  "subtext": "–ü—è—Ç—ë—Ä–æ—á–∫–∞",
  "messages": "",
  "other_text": "–ë–∞–ª–∞–Ω—Å: 45 000 ‚ÇΩ",
  "cat": "payment",
  "new_only": "true"
}
```

### –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–∏:
```json
{
  "owner_app": "com.idamob.tinkoff.android",
  "title": "–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ",
  "text": "+10 000 ‚ÇΩ",
  "subtext": "–ü–µ—Ä–µ–≤–æ–¥ –æ—Ç –ò–≤–∞–Ω –ò.",
  "messages": "",
  "other_text": "–ë–∞–ª–∞–Ω—Å: 55 000 ‚ÇΩ",
  "cat": "income",
  "new_only": "true"
}
```

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ:
```json
{
  "owner_app": "com.idamob.tinkoff.android",
  "title": "–ö—ç—à–±—ç–∫ –Ω–∞—á–∏—Å–ª–µ–Ω",
  "text": "+150 ‚ÇΩ",
  "subtext": "–ó–∞ –ø–æ–∫—É–ø–∫–∏ –≤ —è–Ω–≤–∞—Ä–µ",
  "messages": "",
  "other_text": "–ö–æ–ø–∏—Ç–µ –∫—ç—à–±—ç–∫ –∏ —Ç—Ä–∞—Ç—å—Ç–µ –Ω–∞ —á—Ç–æ —É–≥–æ–¥–Ω–æ",
  "cat": "cashback",
  "new_only": "false"
}
```

---

## ‚öôÔ∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ URL –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å URL, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:

### –í docker-compose-simple.yml:
```yaml
environment:
  - WORKER_TARGET_URL=https://–Ω–æ–≤—ã–π-url.com/endpoint
```

–ó–∞—Ç–µ–º:
```bash
make deploy-full
```
